query getUserStore @auth(level: USER) {
  user(key:  {
     uid_expr: "auth.uid"
  }) {
    store: store_on_owner {
      id
      name
      description
      logoUrl
      status
      phoneNumber
      owner {
        displayName
      }
    }
  }
}

query getAllPendingApprovalStores @auth(level: NO_ACCESS) {
  stores(where:  {
     status:  {
        eq: "pending"
     }
  }) {
    id
    name
    description
    logoUrl
    status
    phoneNumber
    owner {
      displayName
    }
  }
}

query getAllActiveStores @auth(level: NO_ACCESS) {
  stores(where:  {
     status:  {
        eq: "active"
     }
  }) {
    id
    name
    description
    logoUrl
    status
    phoneNumber
    owner {
      displayName
    }
  }
}

query getAllSuspendedStores @auth(level: NO_ACCESS) {
  stores(where:  {
     status:  {
        eq: "suspended"
     }
  }) {
    id
    name
    description
    logoUrl
    status
    phoneNumber
    owner {
      displayName
    }
  }
}

  query getUserCart @auth(level: USER) {
    cart(first:  { where: {userUid:  {
       eq_expr: "auth.uid"
    }}}) {
      id
    items: cartItems_on_cart {
      id
      productVariation {
        id
        product {
          id
          name
        }
        price
        imageUrls
        attributes
        availableStock
      }
      quantity
    }
  }
  }

  query getAllProducts(
    $category: UUID
  ) @auth(level: PUBLIC insecureReason: "Everyone can see products") {
    products(where:  {
       categoryId:  {
          eq: $category
       }
    }) {
        id name description  specifications
        variations: productVariations_on_product(where:  {
           availableStock:  {
              gt: 0
           }
        }) {
            id, price, imageUrls attributes, availableStock
            store {
              id name
            }
        }

    }
}
query getProductById($id: UUID!) @auth(level: PUBLIC insecureReason: "Everyone can see products") {
    product(id: $id) {
        id name description specifications, categoryId
        variations: productVariations_on_product(where:  {
           availableStock:   {
              gt: 0
           }
        }) {
            id, price, imageUrls attributes, availableStock
        }

    }
}

query getProductForStoreOwner($storeId: UUID!) @auth(level: USER, insecureReason: "only owner can see all their products") {
    products(where:  {
        productVariations_on_product:  {
           exist:  {
              storeId:  {
                 eq: $storeId
              
              }
           }
        }
    }) {
        id
        name
        description
        specifications
        productVariations_on_product {
            id, price, imageUrls attributes, availableStock
        }
    }
}

query getStoreProductDetailsForOwner($storeId: UUID!, $productId: UUID!) @auth(level: USER) {
  product(id: $productId){
        id
        name
        description
        specifications
        category {
          variationAttributes
        }
       variation: productVariations_on_product(where:  { storeId:  { eq: $storeId }
        }) {
            id, price, imageUrls attributes, availableStock
        }
    }
}

# ====== Category


query getAllParentCategories @auth(level: PUBLIC) {
    categories(where: {parentCategoryId: {isNull: true}}) { id
  name
  description
  imageUrl
  variationAttributes
  specificationAttributes
  parentCategoryId}
}

query getCategoryById($id: UUID!) @auth(level: PUBLIC) {
    category(id: $id) { id
  name
  description
  imageUrl
  variationAttributes
  specificationAttributes
  parentCategoryId}
}

query getChildrenCategories($id: UUID!) @auth(level: PUBLIC) {
    categories(where: {parentCategoryId: {eq: $id}}) { id
  name
  description
  imageUrl
  variationAttributes
  specificationAttributes
  parentCategoryId}
}

