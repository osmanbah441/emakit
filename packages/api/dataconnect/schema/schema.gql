type Category @table {
  name: String! @unique @col(dataType: "VARCHAR(255)")
  description: String!
  parentCategory: Category
  imageUrl: String! @col(dataType: "VARCHAR(255)")
  status: String! @default(value: "active") @col(dataType: "VARCHAR(50)")
  specificationAttributes: [String]
  variationAttributes: Any
  createdAt: Timestamp! @default(expr: "request.time")
}

type Product @table {
  name: String! @col(dataType: "VARCHAR(255)")
  description: String!
  category: Category!
  status: String! @default(value: "active") @col(dataType: "VARCHAR(50)")
  specifications: Any!
  embeddingText: Vector! @col(size: 3072)
  createdAt: Timestamp! @default(expr: "request.time")
  updatedAt: Timestamp! @default(expr: "request.time")
}

type ProductVariation @table {
  product: Product!
  store: Store!
  price: Float! @col(dataType: "DECIMAL(10, 2)")
  availableStock: Int!
  attributes: Any!
  status: String! @default(value: "available") @col(dataType: "VARCHAR(50)")
  imageUrls: [String!]!
  createdAt: Timestamp! @default(expr: "request.time")
  updatedAt: Timestamp! @default(expr: "request.time")
}

type User @table(key: "uid") {
  uid: String! @default(expr: "auth.uid")
  email: String @unique @col(dataType: "VARCHAR(100)")
  phoneNumber: String @unique @col(dataType: "VARCHAR(20)")
  displayName: String @col(dataType: "VARCHAR(100)")
  photoUrl: String @col(dataType: "VARCHAR(255)")
  createdAt: Timestamp! @default(expr: "request.time")
  updatedAt: Timestamp! @default(expr: "request.time")
}

type Store @table {
  name: String! @unique @col(dataType: "VARCHAR(255)")
  description: String
  logoUrl: String @col(dataType: "VARCHAR(255)")
  phoneNumber: String! @unique @col(dataType: "VARCHAR(20)")
  owner: User! @unique
  status: String! @default(value: "pending") @col(dataType: "VARCHAR(50)")
  createdAt: Timestamp! @default(expr: "request.time")
  updatedAt: Timestamp! @default(expr: "request.time")
}

type Cart @table {
  user: User!
  createdAt: Timestamp! @default(expr: "request.time")
  updatedAt: Timestamp! @default(expr: "request.time")
}

type CartItem @table {
  cart: Cart!
  productVariation: ProductVariation!
  quantity: Int! @default(value: 1)
}

# type Address @table {
#   label: String! @col(dataType: "VARCHAR(50)")
#   addressLine: String
#   district: String
#   province: String
#   longitude: Float
#   latitude: Float
#   isDefault: Boolean! @default(value: false)
#   createdAt: Timestamp! @default(expr: "request.time")
# }

# type Payment @table {
#   user: User!
#   method: String! @col(dataType: "VARCHAR(50)")
#   reference: String @col(dataType: "VARCHAR(255)")
#   amount: Float! @col(dataType: "DECIMAL(10, 2)")
#   createdAt: Timestamp! @default(expr: "request.time")
# }

# type Order @table {
#   user: User!
#   payment: Payment!
#   address: Address!
#   status: String! @default(value: "pending") @col(dataType: "VARCHAR(50)")
#   totalAmount: Float! @col(dataType: "DECIMAL(10, 2)")
#   taxAmount: Float! @col(dataType: "DECIMAL(10, 2)")
#   deliveryFee: Float! @col(dataType: "DECIMAL(10, 2)")
#   createdAt: Timestamp! @default(expr: "request.time")
#   updatedAt: Timestamp! @default(expr: "request.time")
# }

# type StoreOrder @table(key: ["order", "store"]) {
#   order: Order!
#   store: Store!
#   status: OrderStatus! @default(value: PENDING) 
#   deliveryStatus: DeliveryStatus! @default(value: PENDING) 
#   totalAmount: Float! @col(dataType: "DECIMAL(10, 2)")
#   deliveryFee: Float! @col(dataType: "DECIMAL(10, 2)")
#   trackingNumber: String @col(dataType: "VARCHAR(100)")
#   deliveredAt: Timestamp
#   createdAt: Timestamp! @default(expr: "request.time")
#   updatedAt: Timestamp! @default(expr: "request.time")
# }

# type OrderItem @table {
#   storeOrder: StoreOrder!
#   productVariation: ProductVariation!
#   quantity: Int!
#   unitPrice: Float! @col(dataType: "DECIMAL(10, 2)")
#   subtotal: Float! @col(dataType: "DECIMAL(10, 2)")
#   deliveryStatus: DeliveryStatus! @default(value: PENDING)
#   deliveredAt: Timestamp
# }
